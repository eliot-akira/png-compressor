"use strict";var PNGCompressor=(()=>{var l=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var U=Object.prototype.hasOwnProperty;var v=(e,r)=>{for(var o in r)l(e,o,{get:r[o],enumerable:!0})},R=(e,r,o,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of C(r))!U.call(e,n)&&n!==o&&l(e,n,{get:()=>r[n],enumerable:!(t=E(r,n))||t.enumerable});return e};var M=e=>R(l({},"__esModule",{value:!0}),e);var N={};v(N,{blobToImage:()=>B,compress:()=>u,createImage:()=>g,decode:()=>S,decodeBuffer:()=>J,decodeBufferFromPng:()=>m,decodeDataFromImage:()=>y,decompress:()=>p,decompressAsArrayBuffer:()=>p,decompressAsString:()=>O,defaultCompressionFormat:()=>c,downloadImage:()=>D,encode:()=>k,encodeBufferToBlob:()=>f,encodeBufferToPng:()=>b,encodeDataIntoImage:()=>d,encodeToBlob:()=>P,encodeToImage:()=>z,imageElementToBlob:()=>F,imageElementToCanvas:()=>x,imageElementToData:()=>w});function d(e,r){for(let o=0,t=e.length;o<3;o++)r[o]=t/Math.pow(256,o)%256|0;r[3]=255;for(let o=4,t=0,n=r.length;o<n;o+=4,t+=3)r[o]=e[t]||0,r[o+1]=e[t+1]||0,r[o+2]=e[t+2]||0,r[o+3]=255;return r}function y(e){let r=0;for(let t=0;t<3;t++)r+=e[t]*Math.pow(256,t);let o=new Uint8Array(r);e:for(let t=4,n=0,s=e.length;n<s;t+=4,n+=3)for(let a=0;a<3;a++){if(n+a>=r)break e;o[n+a]=e[t+a]}return o.buffer}function g(e,r=document.createElement("img")){let o=URL.createObjectURL(e);return r.src=o,URL.revokeObjectURL(o),r}function D(e,r="compressed.png"){let o=URL.createObjectURL(e),t=document.createElement("a");t.download=r,t.href=o,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(o)}async function F(e){let{canvas:r}=x(e);return new Promise((o,t)=>{r.toBlob(function(n){n?o(n):t(new Error(""))},"image/png")})}async function B(e){return new Promise((r,o)=>{let t=new Image;t.onload=function(){URL.revokeObjectURL(t.src),r(t)},t.onerror=o,t.src=URL.createObjectURL(e)})}function w(e){let{context:r,width:o,height:t}=x(e);return r.getImageData(0,0,o,t).data}function x(e){let r=document.createElement("canvas"),o=r.getContext("2d"),t=r.width=e.naturalWidth,n=r.height=e.naturalHeight;return o?.drawImage(e,0,0),{canvas:r,context:o,width:t,height:n}}async function b(e){return await(await f(e)).arrayBuffer()}async function f(e){let r=new Uint8Array(e);return new Promise((o,t)=>{let n=document.createElement("canvas"),s=n.getContext("2d"),a=Math.ceil(Math.sqrt(r.length/3+1));n.width=a,n.height=a;let A=s?.getImageData(0,0,a,a);d(r,A.data),s?.putImageData(A,0,0),n.toBlob(T=>{T?o(T):t(new Error("Canvas failed to create blob"))},"image/png")})}async function m(e){let r=new Blob([e]),o=await B(r);return y(w(o))}var{CompressionStream:H,DecompressionStream:j,Response:i}=globalThis,c="gzip";async function u(e,r=c){let o=new H(r),t=new i(e).body?.pipeThrough(o);return await new i(t).arrayBuffer()}async function I(e,r=c){let o=new j(r),t=new i(e).body?.pipeThrough(o);return new i(t)}async function p(e,r=c){return(await I(e,r)).arrayBuffer()}async function O(e,r=c){return(await I(e,r)).text()}function h(e){return new TextEncoder().encode(JSON.stringify(e)).buffer}function L(e){return JSON.parse(new TextDecoder().decode(e))}async function k(e){return await b(await u(h(e)))}async function P(e){return await f(await u(h(e)))}async function z(e,r){return g(await P(e),r)}async function S(e){return L(await p(await m(e)))}async function J(e){return await p(await m(e))}return M(N);})();
//# sourceMappingURL=png-compressor.js.map
