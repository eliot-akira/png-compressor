"use strict";(()=>{var L=Object.defineProperty;var R=(e,r)=>{for(var o in r)L(e,o,{get:r[o],enumerable:!0})};var h={};R(h,{arrayBufferToValue:()=>c,blobToImageElement:()=>s,compress:()=>p,decode:()=>z,decodeBinary:()=>l,decodeBinaryFromFile:()=>v,decodeBinaryFromPng:()=>b,decodeDataFromImage:()=>x,decodeFromFile:()=>N,decompress:()=>j,decompressAsArrayBuffer:()=>d,decompressAsString:()=>H,defaultCompressionFormat:()=>i,downloadImage:()=>S,encode:()=>O,encodeBinary:()=>C,encodeBinaryToBlob:()=>m,encodeBinaryToPng:()=>A,encodeDataIntoImage:()=>g,encodeToBlob:()=>I,encodeToImage:()=>k,getBufferfromFile:()=>F,getImageData:()=>B,imageElementToBlob:()=>U,imageElementToCanvas:()=>w,valueToArrayBuffer:()=>y});async function U(e){let{canvas:r}=w(e);return new Promise((o,t)=>{r.toBlob(function(n){n?o(n):t(new Error(""))},"image/png")})}async function s(e,r=document.createElement("img")){return new Promise((o,t)=>{let n=()=>{URL.revokeObjectURL(r.src),r.removeEventListener("load",n),o(r)};r.addEventListener("load",n),r.src=URL.createObjectURL(e)})}function B(e){let{context:r,width:o,height:t}=w(e);return r.getImageData(0,0,o,t).data}function w(e){let r=document.createElement("canvas"),o=r.getContext("2d"),t=r.width=e.naturalWidth,n=r.height=e.naturalHeight;return o?.drawImage(e,0,0),{canvas:r,context:o,width:t,height:n}}function g(e,r){for(let o=0,t=e.length;o<3;o++)r[o]=t/Math.pow(256,o)%256|0;r[3]=255;for(let o=4,t=0,n=r.length;o<n;o+=4,t+=3)r[o]=e[t]||0,r[o+1]=e[t+1]||0,r[o+2]=e[t+2]||0,r[o+3]=255;return r}function x(e){let r=0;for(let t=0;t<3;t++)r+=e[t]*Math.pow(256,t);let o=new Uint8Array(r);e:for(let t=4,n=0,f=e.length;n<f;t+=4,n+=3)for(let a=0;a<3;a++){if(n+a>=r)break e;o[n+a]=e[t+a]}return o.buffer}async function A(e){return await(await m(e)).arrayBuffer()}async function m(e){let r=new Uint8Array(e);return new Promise((o,t)=>{let n=document.createElement("canvas"),f=n.getContext("2d"),a=Math.ceil(Math.sqrt(r.length/3+1));n.width=a,n.height=a;let T=f?.getImageData(0,0,a,a);g(r,T.data),f?.putImageData(T,0,0),n.toBlob(P=>{P?o(P):t(new Error("Canvas failed to create blob"))},"image/png")})}async function b(e){if(!(e instanceof ArrayBuffer))throw new Error("Expected ArrayBuffer but got "+typeof e);let r=new Blob([e]),o=await s(r);return x(B(o))}var{CompressionStream:D,DecompressionStream:M,Response:u}=globalThis,i="gzip";async function p(e,r=i){let o=new D(r),t=new u(e).body?.pipeThrough(o);return await new u(t).arrayBuffer()}async function E(e,r=i){let o=new M(r),t=new u(e).body?.pipeThrough(o);return new u(t)}async function d(e,r=i){return(await E(e,r)).arrayBuffer()}async function H(e,r=i){return(await E(e,r)).text()}var j=d;function y(e){return new TextEncoder().encode(JSON.stringify(e)).buffer}function c(e){return JSON.parse(new TextDecoder().decode(e))}async function O(e){return await C(y(e))}async function I(e){return await m(await p(y(e)))}async function k(e,r){return s(await I(e),r)}async function C(e){return await A(await p(e))}async function z(e){return c(await l(e))}async function l(e){return await d(await b(e))}function S(e,r="compressed.png"){let o=URL.createObjectURL(e),t=document.createElement("a");t.download=r,t.href=o,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(o)}async function v(e){let r=await F(e);return await l(r)}async function N(e){return c(await v(e))}async function F(e){return new Promise((r,o)=>{let t=new FileReader;t.addEventListener("load",()=>{r(t.result)}),t.addEventListener("error",o),t.readAsArrayBuffer(e)})}window.PNGCompressor=h;})();
//# sourceMappingURL=png-compressor.js.map
