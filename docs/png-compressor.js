"use strict";var PNGCompressor=(()=>{var l=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var C=Object.prototype.hasOwnProperty;var E=(e,r)=>{for(var o in r)l(e,o,{get:r[o],enumerable:!0})},U=(e,r,o,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of L(r))!C.call(e,n)&&n!==o&&l(e,n,{get:()=>r[n],enumerable:!(t=P(r,n))||t.enumerable});return e};var v=e=>U(l({},"__esModule",{value:!0}),e);var J={};E(J,{blobToImage:()=>g,compress:()=>u,createImage:()=>R,decode:()=>z,decodeBuffer:()=>S,decodeBufferFromPng:()=>m,decodeDataFromImage:()=>y,decompress:()=>p,decompressAsArrayBuffer:()=>p,decompressAsString:()=>H,defaultCompressionFormat:()=>s,downloadImage:()=>D,encode:()=>O,encodeBufferToBlob:()=>f,encodeBufferToPng:()=>x,encodeDataIntoImage:()=>d,encodeToBlob:()=>k,imageElementToBlob:()=>M,imageElementToCanvas:()=>w,imageElementToData:()=>B});function d(e,r){for(let o=0,t=e.length;o<3;o++)r[o]=t/Math.pow(256,o)%256|0;r[3]=255;for(let o=4,t=0,n=r.length;o<n;o+=4,t+=3)r[o]=e[t]||0,r[o+1]=e[t+1]||0,r[o+2]=e[t+2]||0,r[o+3]=255;return r}function y(e){let r=0;for(let t=0;t<3;t++)r+=e[t]*Math.pow(256,t);let o=new Uint8Array(r);e:for(let t=4,n=0,c=e.length;n<c;t+=4,n+=3)for(let a=0;a<3;a++){if(n+a>=r)break e;o[n+a]=e[t+a]}return o.buffer}async function R(e,r=document.createElement("img")){let o=URL.createObjectURL(e);return r.src=o,URL.revokeObjectURL(o),r}function D(e,r="compressed.png"){let o=URL.createObjectURL(e),t=document.createElement("a");t.download=r,t.href=o,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(o)}async function M(e){let{canvas:r}=w(e);return new Promise((o,t)=>{r.toBlob(function(n){n?o(n):t(new Error(""))},"image/png")})}async function g(e){return new Promise((r,o)=>{let t=new Image;t.onload=function(){URL.revokeObjectURL(t.src),r(t)},t.onerror=o,t.src=URL.createObjectURL(e)})}function B(e){let{context:r,width:o,height:t}=w(e);return r.getImageData(0,0,o,t).data}function w(e){let r=document.createElement("canvas"),o=r.getContext("2d"),t=r.width=e.naturalWidth,n=r.height=e.naturalHeight;return o?.drawImage(e,0,0),{canvas:r,context:o,width:t,height:n}}async function x(e){return await(await f(e)).arrayBuffer()}async function f(e){let r=new Uint8Array(e);return new Promise((o,t)=>{let n=document.createElement("canvas"),c=n.getContext("2d"),a=Math.ceil(Math.sqrt(r.length/3+1));n.width=a,n.height=a;let h=c?.getImageData(0,0,a,a);d(r,h.data),c?.putImageData(h,0,0),n.toBlob(A=>{A?o(A):t(new Error("Canvas failed to create blob"))},"image/png")})}async function m(e){let r=new Blob([e]),o=await g(r);return y(B(o))}var{CompressionStream:F,DecompressionStream:j,Response:i}=globalThis,s="gzip";async function u(e,r=s){let o=new F(r),t=new i(e).body?.pipeThrough(o);return await new i(t).arrayBuffer()}async function T(e,r=s){let o=new j(r),t=new i(e).body?.pipeThrough(o);return new i(t)}async function p(e,r=s){return(await T(e,r)).arrayBuffer()}async function H(e,r=s){return(await T(e,r)).text()}function b(e){return new TextEncoder().encode(JSON.stringify(e)).buffer}function I(e){return JSON.parse(new TextDecoder().decode(e))}async function O(e){return await x(await u(b(e)))}async function k(e){return await f(await u(b(e)))}async function z(e){return I(await p(await m(e)))}async function S(e){return await p(await m(e))}return v(J);})();
//# sourceMappingURL=png-compressor.js.map
